"0","mapPlot<-list()"
"0","histPlot<-list()"
"0","years<-unique(df3$variable)"
"0","length(years)"
"1","[1]"
"1"," 10"
"1","
"
"0","for(i in 1:length(years)){"
"0","	curYear<-years[i]"
"0","	#selection and merging"
"0","	curDf<-data.frame(merge("
"0","	  df3 %>% mutate(countries_name = Continent.Country.of.Nationality) %>% dplyr::filter(!(countries_name %in% c(continent,'Other','Unknown','Total')) & variable==curYear), "
"0","	  countries_name, by='countries_name'))"
"0","	#percentage calculation"
"0","	curDf<-curDf %>% mutate(tot = sum(value,na.rm=T), percentage = round(100*(value/tot),2))"
"0","	#make map"
"0","	mapPlot[[i]]<-world_map + "
"0","	geom_curve(data = filter(curDf,value>0),aes(x=long,y=lat,xend=-95.71289,yend=37.09024,size=percentage,color=percentage),alpha=.5) + "
"0","	theme_fivethirtyeight() + theme("
"0","	  plot.title=element_text(face=""bold"",hjust=.012,vjust=.8,colour=""#3C3C3C"",size=10),"
"0","	  panel.grid.major = element_blank(),"
"0","	  axis.text=element_blank(),axis.ticks=element_blank(),"
"0","	  legend.position = c(.1,0.15),"
"0","	  legend.title=element_text(size=8),"
"0","	  legend.text=element_text(size=8),legend.key.size = unit(.4, ""cm"")) + "
"0","	  scale_color_gradientn(colours=rev(brewer.pal(10,'Spectral'))) + guides(size=F) +"
"0","	ggtitle(paste0('Countries of origin of refugees for ',curYear))"
"0","	"
"0","	histPlot[[i]]<-ggplot() + "
"0","	  geom_bar(data=filter(perContinent,variable!=curYear),aes(x=variable,y=value,fill=Continent.Country.of.Nationality),stat='identity',alpha=.25) + "
"0","	  geom_bar(data=filter(perContinent,variable==curYear),aes(x=variable,y=value,fill= Continent.Country.of.Nationality),stat='identity',alpha=1) + "
"0","	  theme_fivethirtyeight() + "
"0","	  theme("
"0","	    legend.text=element_text(size=8),"
"0","	    legend.key.size = unit(.4, ""cm""),"
"0","	    legend.position=,axis.text.x = element_text(size=8,angle=45)) + "
"0","	  scale_fill_brewer(name='',palette='Set1')"
"0","}"
