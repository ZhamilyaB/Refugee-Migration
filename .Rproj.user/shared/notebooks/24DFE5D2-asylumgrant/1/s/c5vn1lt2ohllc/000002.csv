"0","perCountries<-df2 %>% dplyr::filter(!( Continent.Country.of.Nationality %in% c(continent,'Other','Unknown','Total')))"
"0","perCountries$Tot<-rowSums(perCountries[,2:11],na.rm=T) "
"0","perCountries <- perCountries %>% mutate(tot = sum(Tot,na.rm=T), percentage = round(100*(Tot/tot),2),countries_name=Continent.Country.of.Nationality)"
"0","perCountries <- merge(perCountries, countries_name, by='countries_name')"
"0","allmaps<-world_map + "
"0","	geom_curve(data = filter(perCountries,Tot>0),aes(x=long,y=lat,xend=-95.71289,yend=37.09024,size=percentage,color=percentage),alpha=.5) + "
"0","	theme_fivethirtyeight() + "
"0","	theme(panel.grid.major = element_blank(),"
"0","	axis.text=element_blank(),axis.ticks=element_blank(),"
"0","	legend.position = c(.1,0.15)) + "
"0","	scale_color_gradientn(colours=rev(brewer.pal(10,'Spectral'))) + guides(size=F)"
"0","allyears <-ggplot() + "
"0","  geom_bar(data=perContinent,aes(x=variable,y=value,fill= Continent.Country.of.Nationality),stat='identity',alpha=1) + "
"0","  theme_fivethirtyeight() + "
"0","  theme(axis.text.x = element_text(size=8,angle=45),legend.text=element_text(size=8),"
"0","        legend.key.size = unit(.4, ""cm"")) + scale_fill_brewer(name='',palette='Set1')"
